<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EOL & CVE Checker — Precisión estricta</title>
  <link rel="stylesheet" href="styles.css" />
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; connect-src 'self' https://endoflife.date https://services.nvd.nist.gov; img-src 'self' data:; style-src 'self'; script-src 'self'; base-uri 'none'; form-action 'self'">
</head>
<body>
  <header>
    <h1>EOL & CVE Checker</h1>
    <p class="subtitle">Sistema determinista de evaluación de versiones (v2)</p>
  </header>

  <main>
    <section class="card">
      <h2>Entrada</h2>
      <form id="checker-form">
        <div class="grid">
          <label>
            Vendor (CPE)
            <input id="vendor" placeholder="p.ej.: jquery" required>
          </label>
          <label>
            Product (CPE)
            <input id="product" placeholder="p.ej.: jquery" required>
          </label>
          <label>
            Versión exacta
            <input id="version" placeholder="p.ej.: 3.6.0" required>
          </label>
          <label>
            endoflife.slug (opcional)
            <input id="eolSlug" placeholder="p.ej.: jquery">
          </label>
          <label>
            NVD API Key (opcional)
            <input id="nvdKey" placeholder="mejora límite/rate">
          </label>
        </div>

        <div class="hints">
          <p><strong>CPE base usado:</strong> <code id="cpePreview">cpe:2.3:a:&lt;vendor&gt;:&lt;product&gt;</code></p>
          <p class="note">
            Política “latest-only” activada para: <code>jquery</code>. Se puede editar en <code>app.js</code>.
          </p>
        </div>

        <button type="submit" class="primary">Evaluar</button>
      </form>
    </section>

    <section id="result" class="card hidden" aria-live="polite">
      <h2>Resultado</h2>
      <div id="classification" class="classification"></div>
      <div id="explanation" class="explanation"></div>
      <div id="cveList" class="cve-list hidden">
        <h3>CVEs aplicables confirmados</h3>
        <ul id="cveItems"></ul>
      </div>
    </section>

    <section class="card">
      <h2>Prueba rápida (jQuery 3.6.0)</h2>
      <div class="quicktest">
        <button id="btnTest" class="secondary">Completar y evaluar</button>
        <p class="small">
          Según la política pública de jQuery (“solo la última versión del ciclo está soportada”), 3.6.0 **no** es la última de 3.x (3.7.1 es posterior). [1](https://endoflife.date/jquery)[2](https://jquery.com/support/)
        </p>
      </div>
    </section>
  </main>

  <footer>
    <p>
      <strong>Reglas</strong>: no inferencias, CPE exacto, rangos estrictos, preferir omitir antes que errar.
    </p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
