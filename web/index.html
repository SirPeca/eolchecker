<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EOL & CVE Checker — Precisión estricta</title>

  <!-- CSP estricta para app estática -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 connect-src 'self' https://endoflife.date https://services.nvd.nist.gov;
                 img-src 'self' data:;
                 style-src 'self';
                 script-src 'self';
                 base-uri 'none';
                 form-action 'self'">

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>EOL & CVE Checker</h1>
    <p class="subtitle">Sistema determinista de evaluación de versiones</p>
  </header>

  <main>
    <section class="card">
      <h2>Entrada</h2>
      <form id="checker-form" novalidate>
        <div class="grid">
          <label>
            Software / Librería / Tecnología
            <input id="software" placeholder="p.ej.: openssl" autocomplete="off" required />
          </label>
          <label>
            Versión a chequear
            <input id="version" placeholder="p.ej.: 1.0.1k" autocomplete="off" required />
          </label>
        </div>

        <!-- Opciones avanzadas: ocultas por defecto, para auditoría -->
        <details id="advanced" class="advanced">
          <summary>Opciones avanzadas (auditoría)</summary>
          <div class="grid">
            <label>
              CPE vendor (override)
              <input id="cpeVendor" placeholder="si no coincide con el nombre" autocomplete="off" />
            </label>
            <label>
              CPE product (override)
              <input id="cpeProduct" placeholder="si no coincide con el nombre" autocomplete="off" />
            </label>
            <label>
              endoflife.slug (override)
              <input id="eolSlug" placeholder="p.ej.: openssl" autocomplete="off" />
            </label>
          </div>
          <p class="small">
            Si no completás estos campos, se usa el modo determinista por defecto:<br>
            CPE base <code>cpe:2.3:a:&lt;software&gt;:&lt;software&gt;</code> (minúsculas; espacios → guiones),
            y el <em>slug</em> de endoflife.date será el nombre del software en minúsculas.
          </p>
        </details>

        <div class="hints">
          <p><strong>CPE base:</strong> <code id="cpePreview">cpe:2.3:a:-:-</code></p>
        </div>

        <button type="submit" class="primary">Evaluar</button>
      </form>
    </section>

    <section id="result" class="card hidden" aria-live="polite">
      <h2>Resultado</h2>
      <div id="classification" class="classification"></div>
      <div id="explanation" class="explanation"></div>
      <div id="cveList" class="cve-list hidden">
        <h3>CVEs aplicables confirmados</h3>
        <ul id="cveItems"></ul>
      </div>
    </section>
  </main>

  <footer>
    <p><strong>Reglas:</strong> sin inferencias, CPE exacto, rangos estrictos. Exactitud &gt; cobertura.</p>
  </footer>

  <!-- API key inyectada y auditable (debe ir antes de app.js) -->
  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
